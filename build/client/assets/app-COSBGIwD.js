import{j as o}from"./jsx-runtime-DlxonYWr.js";import{A as c}from"./autoprefixer-CwAGCsAD.js";import{r as m}from"./index-BWtVRBRF.js";import{b as p}from"./index-CSX1f1C-.js";import{P as u}from"./PlanContext-BY9hTbym.js";import{C as f,O as h}from"./CampaignContext-DQOm3mJ9.js";import{s as g}from"./global-DIOG6d_h.js";import{a as C,L as O}from"./components-BEwuW2UH.js";import{u as S,O as y,e as E}from"./index-CuNWEgFx.js";import"./AppProvider-B1ucjflU.js";import"./context-CUwc7ova.js";import"./_commonjsHelpers-gnU0ypJ3.js";import"./context-bB9LgXOD.js";import"./index-Crcs4hqE.js";function x(e){const{parentHeaders:i,loaderHeaders:s,actionHeaders:t,errorHeaders:n}=e;return n&&Array.from(n.entries()).length>0?n:new Headers([...i?Array.from(i.entries()):[],...s?Array.from(s.entries()):[],...t?Array.from(t.entries()):[]])}function A(e){if(e.constructor.name==="ErrorResponse"||e.constructor.name==="ErrorResponseImpl")return o.jsx("div",{dangerouslySetInnerHTML:{__html:e.data||"Handling response"}});throw e}const L={error:A,headers:x};var l={};const G=()=>[{rel:"stylesheet",href:g}];function F(){const e=C(),i=S(),s=e.isThemeEditor,t=e.apiKey||l.SHOPIFY_API_KEY||"",n=new URLSearchParams(i.search);e.shop||n.get("shop");const a=e.host||l.HOST||"";return m.useEffect(()=>{if(!s&&typeof window<"u")if(e.discountCodes&&e.discountCodes.length>0){window.GLOBAL_DISCOUNT_CODES=e.discountCodes,console.log("Root - Setting global discount codes:",e.discountCodes);try{localStorage.setItem("GLOBAL_DISCOUNT_CODES",JSON.stringify(e.discountCodes))}catch(r){console.error("Failed to store discount codes in localStorage:",r)}}else try{const r=localStorage.getItem("GLOBAL_DISCOUNT_CODES");if(r){const d=JSON.parse(r);d&&d.length>0&&(window.GLOBAL_DISCOUNT_CODES=d,console.log("Root - Using stored discount codes from localStorage:",d.length))}}catch(r){console.error("Failed to retrieve discount codes from localStorage:",r)}},[e.discountCodes]),s?o.jsx(c,{isEmbeddedApp:!0,apiKey:t,host:a,children:o.jsx("div",{style:{padding:20},children:o.jsx("h1",{children:"Theme App Embed Loaded"})})}):o.jsxs(c,{isEmbeddedApp:!0,apiKey:t,host:a,children:[o.jsx(p,{children:o.jsx(O,{to:"/app",rel:"home",children:"Home"})}),o.jsx(u,{initialDiscountCodes:e.discountCodes||[],children:o.jsxs(f,{children:[o.jsx(y,{}),o.jsx(h,{position:"top-right"})]})})]})}function K(){return L.error(E())}export{K as ErrorBoundary,F as default,G as links};
