import{j as Kt}from"./jsx-runtime-DlxonYWr.js";import{r as C}from"./index-BWtVRBRF.js";import{u as Xt}from"./PlanContext-BY9hTbym.js";import{R as Jt}from"./index-CSX1f1C-.js";import{b as Yt}from"./index-CaEtZ44U.js";let Zt={data:""},Qt=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Zt,xt=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,er=/\/\*[^]*?\*\/|  +/g,ze=/\n+/g,J=(e,r)=>{let l="",d="",c="";for(let o in e){let p=e[o];o[0]=="@"?o[1]=="i"?l=o+" "+p+";":d+=o[1]=="f"?J(p,o):o+"{"+J(p,o[1]=="k"?"":r)+"}":typeof p=="object"?d+=J(p,r?r.replace(/([^,])+/g,g=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,h=>/&/.test(h)?h.replace(/&/g,g):g?g+" "+h:h)):o):p!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),c+=J.p?J.p(o,p):o+":"+p+";")}return l+(r&&c?r+"{"+c+"}":c)+d},H={},Tt=e=>{if(typeof e=="object"){let r="";for(let l in e)r+=l+Tt(e[l]);return r}return e},tr=(e,r,l,d,c)=>{let o=Tt(e),p=H[o]||(H[o]=(h=>{let v=0,u=11;for(;v<h.length;)u=101*u+h.charCodeAt(v++)>>>0;return"go"+u})(o));if(!H[p]){let h=o!==e?e:(v=>{let u,i,f=[{}];for(;u=xt.exec(v.replace(er,""));)u[4]?f.shift():u[3]?(i=u[3].replace(ze," ").trim(),f.unshift(f[0][i]=f[0][i]||{})):f[0][u[1]]=u[2].replace(ze," ").trim();return f[0]})(e);H[p]=J(c?{["@keyframes "+p]:h}:h,l?"":"."+p)}let g=l&&H.g?H.g:null;return l&&(H.g=H[p]),((h,v,u,i)=>{i?v.data=v.data.replace(i,h):v.data.indexOf(h)===-1&&(v.data=u?h+v.data:v.data+h)})(H[p],r,d,g),p},rr=(e,r,l)=>e.reduce((d,c,o)=>{let p=r[o];if(p&&p.call){let g=p(l),h=g&&g.props&&g.props.className||/^go/.test(g)&&g;p=h?"."+h:g&&typeof g=="object"?g.props?"":J(g,""):g===!1?"":g}return d+c+(p??"")},"");function Oe(e){let r=this||{},l=e.call?e(r.p):e;return tr(l.unshift?l.raw?rr(l,[].slice.call(arguments,1),r.p):l.reduce((d,c)=>Object.assign(d,c&&c.call?c(r.p):c),{}):l,Qt(r.target),r.g,r.o,r.k)}let It,qe,$e;Oe.bind({g:1});let X=Oe.bind({k:1});function nr(e,r,l,d){J.p=r,It=e,qe=l,$e=d}function Y(e,r){let l=this||{};return function(){let d=arguments;function c(o,p){let g=Object.assign({},o),h=g.className||c.className;l.p=Object.assign({theme:qe&&qe()},g),l.o=/ *go\d+/.test(h),g.className=Oe.apply(l,d)+(h?" "+h:"");let v=e;return e[0]&&(v=g.as||e,delete g.as),$e&&v[0]&&$e(g),It(v,g)}return c}}var ir=e=>typeof e=="function",_e=(e,r)=>ir(e)?e(r):e,ar=(()=>{let e=0;return()=>(++e).toString()})(),Rt=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let r=matchMedia("(prefers-reduced-motion: reduce)");e=!r||r.matches}return e}})(),or=20,Nt=(e,r)=>{switch(r.type){case 0:return{...e,toasts:[r.toast,...e.toasts].slice(0,or)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===r.toast.id?{...o,...r.toast}:o)};case 2:let{toast:l}=r;return Nt(e,{type:e.toasts.find(o=>o.id===l.id)?1:0,toast:l});case 3:let{toastId:d}=r;return{...e,toasts:e.toasts.map(o=>o.id===d||d===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return r.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==r.toastId)};case 5:return{...e,pausedAt:r.time};case 6:let c=r.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+c}))}}},be=[],ce={toasts:[],pausedAt:void 0},le=e=>{ce=Nt(ce,e),be.forEach(r=>{r(ce)})},ur={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},sr=(e={})=>{let[r,l]=C.useState(ce),d=C.useRef(ce);C.useEffect(()=>(d.current!==ce&&l(ce),be.push(l),()=>{let o=be.indexOf(l);o>-1&&be.splice(o,1)}),[]);let c=r.toasts.map(o=>{var p,g,h;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((p=e[o.type])==null?void 0:p.removeDelay)||(e==null?void 0:e.removeDelay),duration:o.duration||((g=e[o.type])==null?void 0:g.duration)||(e==null?void 0:e.duration)||ur[o.type],style:{...e.style,...(h=e[o.type])==null?void 0:h.style,...o.style}}});return{...r,toasts:c}},cr=(e,r="blank",l)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:r,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...l,id:(l==null?void 0:l.id)||ar()}),me=e=>(r,l)=>{let d=cr(r,e,l);return le({type:2,toast:d}),d.id},R=(e,r)=>me("blank")(e,r);R.error=me("error");R.success=me("success");R.loading=me("loading");R.custom=me("custom");R.dismiss=e=>{le({type:3,toastId:e})};R.remove=e=>le({type:4,toastId:e});R.promise=(e,r,l)=>{let d=R.loading(r.loading,{...l,...l==null?void 0:l.loading});return typeof e=="function"&&(e=e()),e.then(c=>{let o=r.success?_e(r.success,c):void 0;return o?R.success(o,{id:d,...l,...l==null?void 0:l.success}):R.dismiss(d),c}).catch(c=>{let o=r.error?_e(r.error,c):void 0;o?R.error(o,{id:d,...l,...l==null?void 0:l.error}):R.dismiss(d)}),e};var lr=(e,r)=>{le({type:1,toast:{id:e,height:r}})},dr=()=>{le({type:5,time:Date.now()})},ye=new Map,fr=1e3,pr=(e,r=fr)=>{if(ye.has(e))return;let l=setTimeout(()=>{ye.delete(e),le({type:4,toastId:e})},r);ye.set(e,l)},hr=e=>{let{toasts:r,pausedAt:l}=sr(e);C.useEffect(()=>{if(l)return;let o=Date.now(),p=r.map(g=>{if(g.duration===1/0)return;let h=(g.duration||0)+g.pauseDuration-(o-g.createdAt);if(h<0){g.visible&&R.dismiss(g.id);return}return setTimeout(()=>R.dismiss(g.id),h)});return()=>{p.forEach(g=>g&&clearTimeout(g))}},[r,l]);let d=C.useCallback(()=>{l&&le({type:6,time:Date.now()})},[l]),c=C.useCallback((o,p)=>{let{reverseOrder:g=!1,gutter:h=8,defaultPosition:v}=p||{},u=r.filter(n=>(n.position||v)===(o.position||v)&&n.height),i=u.findIndex(n=>n.id===o.id),f=u.filter((n,a)=>a<i&&n.visible).length;return u.filter(n=>n.visible).slice(...g?[f+1]:[0,f]).reduce((n,a)=>n+(a.height||0)+h,0)},[r]);return C.useEffect(()=>{r.forEach(o=>{if(o.dismissed)pr(o.id,o.removeDelay);else{let p=ye.get(o.id);p&&(clearTimeout(p),ye.delete(o.id))}})},[r]),{toasts:r,handlers:{updateHeight:lr,startPause:dr,endPause:d,calculateOffset:c}}},yr=X`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,mr=X`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,gr=X`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,vr=Y("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${yr} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${mr} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${gr} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,br=X`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,_r=Y("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${br} 1s linear infinite;
`,Ar=X`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Or=X`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Pr=Y("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Ar} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Or} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Er=Y("div")`
  position: absolute;
`,Sr=Y("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,wr=X`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Cr=Y("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${wr} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Mr=({toast:e})=>{let{icon:r,type:l,iconTheme:d}=e;return r!==void 0?typeof r=="string"?C.createElement(Cr,null,r):r:l==="blank"?null:C.createElement(Sr,null,C.createElement(_r,{...d}),l!=="loading"&&C.createElement(Er,null,l==="error"?C.createElement(vr,{...d}):C.createElement(Pr,{...d})))},Tr=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Ir=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,Rr="0%{opacity:0;} 100%{opacity:1;}",Nr="0%{opacity:1;} 100%{opacity:0;}",jr=Y("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Dr=Y("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,kr=(e,r)=>{let l=e.includes("top")?1:-1,[d,c]=Rt()?[Rr,Nr]:[Tr(l),Ir(l)];return{animation:r?`${X(d)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${X(c)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Ur=C.memo(({toast:e,position:r,style:l,children:d})=>{let c=e.height?kr(e.position||r||"top-center",e.visible):{opacity:0},o=C.createElement(Mr,{toast:e}),p=C.createElement(Dr,{...e.ariaProps},_e(e.message,e));return C.createElement(jr,{className:e.className,style:{...c,...l,...e.style}},typeof d=="function"?d({icon:o,message:p}):C.createElement(C.Fragment,null,o,p))});nr(C.createElement);var Lr=({id:e,className:r,style:l,onHeightUpdate:d,children:c})=>{let o=C.useCallback(p=>{if(p){let g=()=>{let h=p.getBoundingClientRect().height;d(e,h)};g(),new MutationObserver(g).observe(p,{subtree:!0,childList:!0,characterData:!0})}},[e,d]);return C.createElement("div",{ref:o,className:r,style:l},c)},Fr=(e,r)=>{let l=e.includes("top"),d=l?{top:0}:{bottom:0},c=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Rt()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${r*(l?1:-1)}px)`,...d,...c}},Br=Oe`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ge=16,mn=({reverseOrder:e,position:r="top-center",toastOptions:l,gutter:d,children:c,containerStyle:o,containerClassName:p})=>{let{toasts:g,handlers:h}=hr(l);return C.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:ge,left:ge,right:ge,bottom:ge,pointerEvents:"none",...o},className:p,onMouseEnter:h.startPause,onMouseLeave:h.endPause},g.map(v=>{let u=v.position||r,i=h.calculateOffset(v,{reverseOrder:e,gutter:d,defaultPosition:r}),f=Fr(u,i);return C.createElement(Lr,{id:v.id,key:v.id,onHeightUpdate:h.updateHeight,className:v.visible?Br:"",style:f},v.type==="custom"?_e(v.message,v):c?c(v):C.createElement(Ur,{toast:v,position:u}))}))},ee={},te={},W={},Se={},re={},pe={},ne={},he={},ve={},Ve;function qr(){if(Ve)return ve;Ve=1,Object.defineProperty(ve,"__esModule",{value:!0});function e(r,l){if(l==null||typeof r>"u"||!Object.prototype.isPrototypeOf.call(Object.getPrototypeOf(r),l)||l.constructor.name!=="Object"&&l.constructor.name!=="Array")return l;var d={};return Object.keys(l).forEach(function(c){var o=Object.prototype.hasOwnProperty.call(r,c);o&&typeof r[c]=="object"&&!Array.isArray(r[c])?d[c]=e(r[c],l[c]):d[c]=l[c]}),Object.keys(r).forEach(function(c){var o=Object.prototype.hasOwnProperty.call(l,c);o||(d[c]=r[c])}),Object.setPrototypeOf(d,Object.getPrototypeOf(r)),d}return ve.default=e,ve}var ie={},He;function jt(){return He||(He=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.SEPARATOR=ie.PREFIX=void 0,ie.PREFIX="APP",ie.SEPARATOR="::"),ie}var we={},Ke;function Z(){return Ke||(Ke=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ComponentType=e.Group=void 0,function(r){r.AuthCode="AuthCode",r.Button="Button",r.ButtonGroup="ButtonGroup",r.Cart="Cart",r.Client="Client",r.ContextualSaveBar="ContextualSaveBar",r.Error="Error",r.Features="Features",r.FeedbackModal="FeedbackModal",r.Fullscreen="Fullscreen",r.LeaveConfirmation="LeaveConfirmation",r.Link="Link",r.Loading="Loading",r.Menu="Menu",r.Modal="Modal",r.Navigation="Navigation",r.Performance="Performance",r.Pos="Pos",r.Print="Print",r.ResourcePicker="Resource_Picker",r.unstable_Picker="unstable_Picker",r.Scanner="Scanner",r.SessionToken="SessionToken",r.Share="Share",r.TitleBar="TitleBar",r.Toast="Toast",r.MarketingExternalActivityTopBar="MarketingExternalActivityTopBar",r.WebVitals="WebVitals"}(e.Group||(e.Group={})),function(r){r.Button="Button",r.ButtonGroup="ButtonGroup"}(e.ComponentType||(e.ComponentType={}))}(we)),we}var Xe;function Q(){return Xe||(Xe=1,function(e){var r=he&&he.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.updateActionFromPayload=e.isValidOptionalString=e.isValidOptionalNumber=e.forEachInEnum=e.getMergedProps=e.findMatchInEnum=e.getEventNameSpace=e.NonSnakeCaseGroup=e.actionWrapper=void 0;var l=r(qr()),d=jt(),c=Z();function o(t){return t}e.actionWrapper=o,e.NonSnakeCaseGroup=[c.Group.AuthCode,c.Group.Button,c.Group.ButtonGroup,c.Group.Cart,c.Group.Error,c.Group.Features,c.Group.Fullscreen,c.Group.Link,c.Group.Loading,c.Group.Menu,c.Group.Modal,c.Group.Navigation,c.Group.Pos,c.Group.Print,c.Group.ResourcePicker,c.Group.Scanner,c.Group.SessionToken,c.Group.Share,c.Group.TitleBar,c.Group.Toast,c.Group.unstable_Picker];function p(t){return t.replace(/([A-Z])/g,function(s,y,b){return(b===0?"":"_")+s[0].toLowerCase()})}function g(t){return e.NonSnakeCaseGroup.includes(t)?t.toUpperCase():p(t).toUpperCase()}function h(t,s,y){if(s.startsWith(""+d.PREFIX+d.SEPARATOR))return s;var b=g(t);if(y){var _=y.subgroups,P=y.type;_&&_.length>0&&(b+=b.length>0?d.SEPARATOR:"",_.forEach(function(T,S){b+=""+T.toUpperCase()+(S<_.length-1?d.SEPARATOR:"")})),P!==t&&P&&(b+=""+(b.length>0?d.SEPARATOR:"")+P.toUpperCase())}return b&&(b+=""+(b.length>0?d.SEPARATOR:"")+s.toUpperCase()),""+d.PREFIX+d.SEPARATOR+b}e.getEventNameSpace=h;function v(t,s){var y=Object.keys(t).find(function(b){return s===t[b]});return y?t[y]:void 0}e.findMatchInEnum=v;function u(t,s){var y=l.default(t,s);if(!y){var b=Object.assign(t,s);return b}return y}e.getMergedProps=u;function i(t,s){Object.keys(t).forEach(function(y){s(t[y])})}e.forEachInEnum=i;function f(t){return t==null||typeof t=="number"}e.isValidOptionalNumber=f;function n(t){return t==null||typeof t=="string"}e.isValidOptionalString=n;function a(t,s){var y=t.id;return y===s.id?(Object.assign(t,u(t,s)),!0):!1}e.updateActionFromPayload=a}(he)),he}var U={},Ce={},Je;function We(){return Je||(Je=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LifecycleHook=e.PermissionType=e.MessageType=void 0,function(r){r.GetState="getState",r.Dispatch="dispatch",r.Subscribe="subscribe",r.Unsubscribe="unsubscribe"}(e.MessageType||(e.MessageType={})),function(r){r.Dispatch="Dispatch",r.Subscribe="Subscribe"}(e.PermissionType||(e.PermissionType={})),function(r){r.UpdateAction="UpdateAction",r.DispatchAction="DispatchAction"}(e.LifecycleHook||(e.LifecycleHook={}))}(Ce)),Ce}var ae={},Ye;function Dt(){if(Ye)return ae;Ye=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.removeFromCollection=ae.addAndRemoveFromCollection=void 0;function e(l,d,c){return l.push(d),function(){return r(l,d,c)}}ae.addAndRemoveFromCollection=e;function r(l,d,c){var o=l.findIndex(function(p){return p===d});return o>=0?(l.splice(o,1),c&&c(d),!0):!1}return ae.removeFromCollection=r,ae}var Me={},Ze;function Ae(){return Ze||(Ze=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.permissionAction=e.isErrorEventName=e.throwError=e.invalidOriginAction=e.fromAction=e.AppBridgeError=e.AppActionType=e.Action=void 0;var r=Z(),l=Q(),d;(function(i){i.INVALID_ACTION="APP::ERROR::INVALID_ACTION",i.INVALID_ACTION_TYPE="APP::ERROR::INVALID_ACTION_TYPE",i.INVALID_PAYLOAD="APP::ERROR::INVALID_PAYLOAD",i.INVALID_OPTIONS="APP::ERROR::INVALID_OPTIONS",i.UNEXPECTED_ACTION="APP::ERROR::UNEXPECTED_ACTION",i.PERSISTENCE="APP::ERROR::PERSISTENCE",i.UNSUPPORTED_OPERATION="APP::ERROR::UNSUPPORTED_OPERATION",i.NETWORK="APP::ERROR::NETWORK",i.PERMISSION="APP::ERROR::PERMISSION",i.FAILED_AUTHENTICATION="APP::ERROR::FAILED_AUTHENTICATION",i.INVALID_ORIGIN="APP::ERROR::INVALID_ORIGIN"})(d=e.Action||(e.Action={})),function(i){i.INVALID_CONFIG="APP::ERROR::INVALID_CONFIG",i.MISSING_CONFIG="APP::APP_ERROR::MISSING_CONFIG",i.MISSING_APP_BRIDGE_MIDDLEWARE="APP::APP_ERROR::MISSING_APP_BRIDGE_MIDDLEWARE",i.WINDOW_UNDEFINED="APP::APP_ERROR::WINDOW_UNDEFINED",i.REDUX_REINSTANTIATED="APP::APP_ERROR::REDUX_REINSTANTIATED",i.MISSING_LOCAL_ORIGIN="APP::APP_ERROR::MISSING_LOCAL_ORIGIN",i.MISSING_HOST_PROVIDER="APP::APP_ERROR::MISSING_HOST_PROVIDER",i.MISSING_ROUTER_CONTEXT="APP::APP_ERROR::MISSING_ROUTER_CONTEXT",i.MISSING_HISTORY_BLOCK="APP::APP_ERROR::MISSING_HISTORY_BLOCK"}(e.AppActionType||(e.AppActionType={}));var c=function(){function i(f){this.name="AppBridgeError",this.message=f,typeof Error.captureStackTrace=="function"?Error.captureStackTrace(this,this.constructor):this.stack=new Error(this.message).stack}return i}();e.AppBridgeError=c,c.prototype=Object.create(Error.prototype);function o(i,f,n){var a=i?f+": "+i:f,t=new c(a);return t.action=n,t.type=f,t}e.fromAction=o;function p(i){return l.actionWrapper({group:r.Group.Error,payload:{message:i,type:d.INVALID_ORIGIN},type:d.INVALID_ORIGIN})}e.invalidOriginAction=p;function g(){for(var i=[],f=0;f<arguments.length;f++)i[f]=arguments[f];var n=i[0],a,t;throw typeof i[1]=="string"?a=i[1]:(t=i[1],a=i[2]||""),o(a,n,t)}e.throwError=g;function h(i){var f=l.findMatchInEnum(d,i);return typeof f=="string"}e.isErrorEventName=h;function v(i,f,n){var a=f.payload;return l.actionWrapper({type:i,group:r.Group.Error,payload:{action:f,message:n,type:i,id:a&&a.id?a.id:void 0}})}function u(i,f){return v(d.PERMISSION,i,f||"Action is not permitted")}e.permissionAction=u}(Me)),Me}var de={},Qe;function kt(){if(Qe)return de;Qe=1,Object.defineProperty(de,"__esModule",{value:!0}),de.generateUuid=void 0;function e(d){return Array.from(d).map(function(c){return("00"+c.toString(16)).slice(-2)}).join("")}function r(d){if(typeof Uint8Array=="function"&&typeof window=="object"&&window.crypto){var c=new Uint8Array(d),o=window.crypto.getRandomValues(c);if(o)return o}return Array.from(new Array(d),function(){return Math.random()*255|0})}function l(){var d=64,c=r(1),o=r(2);return c[0]&=191,o[0]&=15|d,[e(r(4)),"-",e(r(2)),"-",e(o),"-",e(c),e(r(1)),"-",e(r(6))].join("")}return de.generateUuid=l,de.default=l,de}var xe;function Ut(){if(xe)return U;xe=1;var e=U&&U.__extends||function(){var n=function(a,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,y){s.__proto__=y}||function(s,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(s[b]=y[b])},n(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(a,t);function s(){this.constructor=a}a.prototype=t===null?Object.create(t):(s.prototype=t.prototype,new s)}}(),r=U&&U.__assign||function(){return r=Object.assign||function(n){for(var a,t=1,s=arguments.length;t<s;t++){a=arguments[t];for(var y in a)Object.prototype.hasOwnProperty.call(a,y)&&(n[y]=a[y])}return n},r.apply(this,arguments)},l=U&&U.__spreadArray||function(n,a){for(var t=0,s=a.length,y=n.length;t<s;t++,y++)n[y]=a[t];return n},d=U&&U.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(U,"__esModule",{value:!0}),U.unsubscribeActions=U.ActionSetWithChildren=U.ActionSet=void 0;var c=We(),o=Dt(),p=Ae(),g=Z(),h=d(kt()),v=Q(),u=function(){function n(a,t,s,y){var b=this;this.app=a,this.type=t,this.group=s,this.subgroups=[],this.subscriptions=[],a||p.throwError(p.Action.INVALID_ACTION,"Missing required `app`"),this.id=y||h.default(),this.defaultGroup=s;var _=this.set;this.set=function(){for(var P,T=[],S=0;S<arguments.length;S++)T[S]=arguments[S];return b.app.hooks?(P=b.app.hooks).run.apply(P,l([c.LifecycleHook.UpdateAction,_,b],T)):_.apply(b,T)}}return n.prototype.set=function(){},Object.defineProperty(n.prototype,"component",{get:function(){return{id:this.id,subgroups:this.subgroups,type:this.type}},enumerable:!1,configurable:!0}),n.prototype.updateSubscription=function(a,t,s){var y=a.eventType,b=a.callback,_=a.component,P;return P=this.subscriptions.findIndex(function(T){return T===a}),P>=0?this.subscriptions[P].unsubscribe():P=void 0,this.group=t,this.subgroups=s,Object.assign(_,{subgroups:this.subgroups}),this.subscribe(y,b,_,P)},n.prototype.error=function(a){var t=this,s=[];return v.forEachInEnum(p.Action,function(y){s.push(t.subscriptions.length),t.subscribe(y,a)}),function(){var y=s.map(function(b){return t.subscriptions[b]});y.forEach(function(b){o.removeFromCollection(t.subscriptions,b,function(_){_.unsubscribe()})})}},n.prototype.subscribe=function(a,t,s,y){var b=this,_=s||this.component,P=a.toUpperCase(),T=typeof y=="number"?t:t.bind(this),S;p.isErrorEventName(a)?S=v.getEventNameSpace(g.Group.Error,a,r(r({},_),{type:""})):S=v.getEventNameSpace(this.group,a,_);var I=this.app.subscribe(S,T,s?s.id:this.id),M={eventType:P,unsubscribe:I,callback:T,component:_,updateSubscribe:function(N,j){return b.updateSubscription(M,N,j)}};return typeof y=="number"&&y>=0&&y<this.subscriptions.length?this.subscriptions[y]=M:this.subscriptions.push(M),I},n.prototype.unsubscribe=function(a){return a===void 0&&(a=!1),f(this.subscriptions,this.defaultGroup,a),this},n}();U.ActionSet=u;var i=function(n){e(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.children=[],t}return a.prototype.unsubscribe=function(t,s){return t===void 0&&(t=!0),s===void 0&&(s=!1),f(this.subscriptions,this.defaultGroup,s),this.children.forEach(function(y){y instanceof a?y.unsubscribe(t,!t):y.unsubscribe(!t)}),this},a.prototype.getChild=function(t){var s=this.children.findIndex(function(y){return y.id===t});return s>=0?this.children[s]:void 0},a.prototype.getChildIndex=function(t){return this.children.findIndex(function(s){return s.id===t})},a.prototype.getChildSubscriptions=function(t,s){return this.subscriptions.filter(function(y){return y.component.id===t&&(!s||s===y.eventType)})},a.prototype.addChild=function(t,s,y){var b=this,_=t.subscriptions,P=this.getChild(t.id);return P||this.children.push(t),!_||s===t.group&&y===t.subgroups?this:(_.forEach(function(T){var S=T.updateSubscribe;S(s,y)}),Object.assign(t,{group:s,subgroups:y}),t instanceof a&&t.children.forEach(function(T){return b.addChild(T,s,y)}),this)},a.prototype.removeChild=function(t){var s=this;return o.removeFromCollection(this.children,this.getChild(t),function(){var y=s.subscriptions.filter(function(b){return b.component.id===t});y.forEach(function(b){o.removeFromCollection(s.subscriptions,b,function(_){_.unsubscribe()})})}),this},a.prototype.subscribeToChild=function(t,s,y){var b=this,_=y.bind(this);if(s instanceof Array)return s.forEach(function(I){return b.subscribeToChild(t,I,y)}),this;if(typeof s!="string")return this;var P=s.toUpperCase(),T=this.getChildSubscriptions(t.id,P);if(T.length>0)T.forEach(function(I){return I.updateSubscribe(b.group,t.subgroups)});else{var S={id:t.id,subgroups:t.subgroups,type:t.type};this.subscribe(P,_,S)}return this},a.prototype.getUpdatedChildActions=function(t,s){if(t.length===0){for(;s.length>0;){var y=s.pop();if(!y)break;this.removeChild(y.id)}return}for(var b=t.filter(function(T,S,I){return S===I.indexOf(T)}),_=b.map(function(T){return T.id}),P=s.filter(function(T){return _.indexOf(T.id)<0});P.length>0;){var y=P.pop();if(!y)break;this.removeChild(y.id)}return b},a}(u);U.ActionSetWithChildren=i;function f(n,a,t){t===void 0&&(t=!1),n.forEach(function(s){if(t){var y=s.updateSubscribe;y(a,[])}else{var b=s.unsubscribe;b()}}),t||(n.length=0)}return U.unsubscribeActions=f,U}var et;function Lt(){return et||(et=1,function(e){var r=ne&&ne.__extends||function(){var u=function(i,f){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(n[t]=a[t])},u(i,f)};return function(i,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");u(i,f);function n(){this.constructor=i}i.prototype=f===null?Object.create(f):(n.prototype=f.prototype,new n)}}(),l=ne&&ne.__assign||function(){return l=Object.assign||function(u){for(var i,f=1,n=arguments.length;f<n;f++){i=arguments[f];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(u[a]=i[a])}return u},l.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Button=e.update=e.clickButton=e.Style=e.Icon=e.Action=void 0;var d=Q(),c=Ut(),o=Z(),p;(function(u){u.CLICK="CLICK",u.UPDATE="UPDATE"})(p=e.Action||(e.Action={})),function(u){u.Print="print"}(e.Icon||(e.Icon={})),function(u){u.Danger="danger"}(e.Style||(e.Style={}));function g(u,i,f){var n=i.id,a=d.getEventNameSpace(u,p.CLICK,i),t={id:n,payload:f};return d.actionWrapper({type:a,group:u,payload:t})}e.clickButton=g;function h(u,i,f){var n=i.id,a=f.label,t=d.getEventNameSpace(u,p.UPDATE,i),s=l(l({},f),{id:n,label:a});return d.actionWrapper({type:t,group:u,payload:s})}e.update=h;var v=function(u){r(i,u);function i(f,n){var a=u.call(this,f,o.ComponentType.Button,o.Group.Button)||this;return a.disabled=!1,a.loading=!1,a.plain=!1,a.set(n,!1),a}return Object.defineProperty(i.prototype,"options",{get:function(){return{disabled:this.disabled,icon:this.icon,label:this.label,style:this.style,loading:this.loading,plain:this.plain}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"payload",{get:function(){return l(l({},this.options),{id:this.id})},enumerable:!1,configurable:!0}),i.prototype.set=function(f,n){n===void 0&&(n=!0);var a=d.getMergedProps(this.options,f),t=a.label,s=a.disabled,y=a.icon,b=a.style,_=a.loading,P=a.plain;return this.label=t,this.disabled=!!s,this.icon=y,this.style=b,this.loading=!!_,this.plain=!!P,n&&this.dispatch(p.UPDATE),this},i.prototype.dispatch=function(f,n){switch(f){case p.CLICK:this.app.dispatch(g(this.group,this.component,n));break;case p.UPDATE:{var a=h(this.group,this.component,this.payload);this.app.dispatch(a);break}}return this},i}(c.ActionSet);e.Button=v}(ne)),ne}var tt;function $r(){if(tt)return pe;tt=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.getSingleButton=void 0;var e=Lt();function r(l,d,c,o){return l.addChild(d,l.group,c),l.subscribeToChild(d,e.Action.UPDATE,o),d.payload}return pe.getSingleButton=r,pe}var rt;function nt(){return rt||(rt=1,function(e){var r=re&&re.__extends||function(){var S=function(I,M){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,j){N.__proto__=j}||function(N,j){for(var D in j)Object.prototype.hasOwnProperty.call(j,D)&&(N[D]=j[D])},S(I,M)};return function(I,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");S(I,M);function N(){this.constructor=I}I.prototype=M===null?Object.create(M):(N.prototype=M.prototype,new N)}}(),l=re&&re.__assign||function(){return l=Object.assign||function(S){for(var I,M=1,N=arguments.length;M<N;M++){I=arguments[M];for(var j in I)Object.prototype.hasOwnProperty.call(I,j)&&(S[j]=I[j])}return S},l.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.ModalIframe=e.ModalMessage=e.Modal=e.isMessageModal=e.isIframeModal=e.data=e.update=e.clickFooterButton=e.updateModalSize=e.closeModal=e.openModal=e.Size=e.Action=void 0;var d=$r(),c=Q(),o=Ut(),p=Z(),g=Lt(),h;(function(S){S.OPEN="APP::MODAL::OPEN",S.CLOSE="APP::MODAL::CLOSE",S.UPDATE="APP::MODAL::UPDATE",S.UPDATE_CONTENT="APP::MODAL::CONTENT::UPDATE",S.FOOTER_BUTTON_CLICK="APP::MODAL::FOOTER::BUTTON::CLICK",S.FOOTER_BUTTON_UPDATE="APP::MODAL::FOOTER::BUTTON::UPDATE",S.UPDATE_SIZE="APP::MODAL::UPDATE_SIZE",S.DATA="APP::MODAL::DATA"})(h=e.Action||(e.Action={}));var v;(function(S){S.Small="small",S.Medium="medium",S.Large="large",S.Full="full",S.Auto="auto"})(v=e.Size||(e.Size={}));var u={group:p.Group.Modal,subgroups:["Footer"],type:p.ComponentType.Button};function i(S){return c.actionWrapper({group:p.Group.Modal,payload:S,type:h.OPEN})}e.openModal=i;function f(S){return c.actionWrapper({group:p.Group.Modal,payload:S,type:h.CLOSE})}e.closeModal=f;function n(S){return c.actionWrapper({group:p.Group.Modal,payload:S,type:h.UPDATE_SIZE})}e.updateModalSize=n;function a(S,I){var M=l({id:S},u);return g.clickButton(p.Group.Modal,M,I)}e.clickFooterButton=a;function t(S){return c.actionWrapper({payload:S,group:p.Group.Modal,type:h.UPDATE})}e.update=t;function s(S){return c.actionWrapper({payload:S,group:p.Group.Modal,type:h.DATA})}e.data=s;function y(S){return typeof S.url=="string"||typeof S.path=="string"}e.isIframeModal=y;function b(S){return typeof S.message=="string"}e.isMessageModal=b;var _=function(S){r(I,S);function I(){var M=S!==null&&S.apply(this,arguments)||this;return M.size=v.Small,M}return Object.defineProperty(I.prototype,"footer",{get:function(){if(!(!this.footerPrimary&&!this.footerSecondary))return{buttons:{primary:this.footerPrimary,secondary:this.footerSecondary}}},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"footerOptions",{get:function(){if(!(!this.footerPrimaryOptions&&!this.footerSecondaryOptions))return{buttons:{primary:this.footerPrimaryOptions,secondary:this.footerSecondaryOptions}}},enumerable:!1,configurable:!0}),I.prototype.close=function(){this.app.dispatch(f({id:this.id}))},I.prototype.setFooterPrimaryButton=function(M,N){var j=this,D=u.subgroups;this.footerPrimaryOptions=this.getChildButton(M,this.footerPrimaryOptions),this.footerPrimary=this.footerPrimaryOptions?d.getSingleButton(this,this.footerPrimaryOptions,D,function(F){j.updatePrimaryFooterButton(F,N)}):void 0},I.prototype.setFooterSecondaryButtons=function(M,N){var j=this,D=u.subgroups,F=M||[],B=this.footerOptions&&this.footerOptions.buttons.secondary||[];this.footerSecondaryOptions=this.getUpdatedChildActions(F,B),this.footerSecondary=this.footerSecondaryOptions?this.footerSecondaryOptions.map(function(x){return d.getSingleButton(j,x,D,function(V){j.updateSecondaryFooterButton(V,N)})}):void 0},I.prototype.getChildButton=function(M,N){var j=M?[M]:[],D=N?[N]:[],F=this.getUpdatedChildActions(j,D);return F?F[0]:void 0},I.prototype.updatePrimaryFooterButton=function(M,N){!this.footer||!this.footer.buttons.primary||c.updateActionFromPayload(this.footer.buttons.primary,M)&&N()},I.prototype.updateSecondaryFooterButton=function(M,N){if(!(!this.footer||!this.footer.buttons||!this.footer.buttons.secondary)){for(var j,D=0,F=this.footer.buttons.secondary;D<F.length;D++){var B=F[D];if(j=c.updateActionFromPayload(B,M),j)break}j&&N()}},I}(o.ActionSetWithChildren);e.Modal=_;var P=function(S){r(I,S);function I(M,N){var j=S.call(this,M,p.Group.Modal,p.Group.Modal)||this;return j.set(N,!1),j}return Object.defineProperty(I.prototype,"payload",{get:function(){return l(l({},this.options),{footer:this.footer,id:this.id})},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"options",{get:function(){return{footer:this.footerOptions,message:this.message,size:this.size,title:this.title}},enumerable:!1,configurable:!0}),I.prototype.set=function(M,N){var j=this;N===void 0&&(N=!0);var D=c.getMergedProps(this.options,M),F=D.title,B=D.footer,x=D.message,V=D.size;return this.title=F,this.message=x,this.size=V,this.setFooterPrimaryButton(B?B.buttons.primary:void 0,function(){j.dispatch(h.UPDATE)}),this.setFooterSecondaryButtons(B?B.buttons.secondary:void 0,function(){j.dispatch(h.UPDATE)}),N&&this.dispatch(h.UPDATE),this},I.prototype.dispatch=function(M){switch(M){case h.OPEN:this.app.dispatch(i(this.payload));break;case h.CLOSE:this.close();break;case h.UPDATE:this.app.dispatch(t(this.payload));break}return this},I}(_);e.ModalMessage=P;var T=function(S){r(I,S);function I(M,N){var j=S.call(this,M,p.Group.Modal,p.Group.Modal)||this;return j.set(N,!1),j}return Object.defineProperty(I.prototype,"payload",{get:function(){return l(l({},this.options),{footer:this.footer,id:this.id})},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"options",{get:function(){return{footer:this.footerOptions,path:this.path,size:this.size,title:this.title,url:this.url,loading:this.loading}},enumerable:!1,configurable:!0}),I.prototype.set=function(M,N){var j=this;N===void 0&&(N=!0);var D=c.getMergedProps(this.options,M),F=D.title,B=D.footer,x=D.path,V=D.url,Pe=D.size,Ee=D.loading;return this.title=F,this.url=V,this.path=x,this.size=Pe,this.loading=Ee,this.setFooterPrimaryButton(B?B.buttons.primary:void 0,function(){j.dispatch(h.UPDATE)}),this.setFooterSecondaryButtons(B?B.buttons.secondary:void 0,function(){j.dispatch(h.UPDATE)}),N&&this.dispatch(h.UPDATE),this},I.prototype.dispatch=function(M,N){switch(M){case h.OPEN:this.app.dispatch(i(this.payload));break;case h.CLOSE:this.close();break;case h.UPDATE:this.app.dispatch(t(this.payload));break;case h.DATA:this.app.dispatch(s(N||{}));break}return this},I}(_);e.ModalIframe=T}(re)),re}var it;function Gr(){return it||(it=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.create=e.Modal=e.isMessageModal=e.data=e.update=e.clickFooterButton=e.updateModalSize=e.closeModal=e.openModal=e.Size=e.Action=e.isIframeModal=e.ModalMessage=e.ModalIframe=void 0;var r=nt();Object.defineProperty(e,"ModalIframe",{enumerable:!0,get:function(){return r.ModalIframe}}),Object.defineProperty(e,"ModalMessage",{enumerable:!0,get:function(){return r.ModalMessage}}),Object.defineProperty(e,"isIframeModal",{enumerable:!0,get:function(){return r.isIframeModal}});var l=nt();Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return l.Action}}),Object.defineProperty(e,"Size",{enumerable:!0,get:function(){return l.Size}}),Object.defineProperty(e,"openModal",{enumerable:!0,get:function(){return l.openModal}}),Object.defineProperty(e,"closeModal",{enumerable:!0,get:function(){return l.closeModal}}),Object.defineProperty(e,"updateModalSize",{enumerable:!0,get:function(){return l.updateModalSize}}),Object.defineProperty(e,"clickFooterButton",{enumerable:!0,get:function(){return l.clickFooterButton}}),Object.defineProperty(e,"update",{enumerable:!0,get:function(){return l.update}}),Object.defineProperty(e,"data",{enumerable:!0,get:function(){return l.data}}),Object.defineProperty(e,"isMessageModal",{enumerable:!0,get:function(){return l.isMessageModal}}),Object.defineProperty(e,"Modal",{enumerable:!0,get:function(){return l.Modal}});var d=function(c,o){return r.isIframeModal(o)?new r.ModalIframe(c,o):new r.ModalMessage(c,o)};e.create=d}(Se)),Se}var oe={},Te={},$={},at;function Wr(){if(at)return $;at=1,Object.defineProperty($,"__esModule",{value:!0}),$.isPermitted=$.getPermissionKey=$.isPerformanceOrWebVitalsAction=$.isAppMessage=$.isAppBridgeAction=void 0;var e=We(),r=jt(),l=Q();function d(h){return h instanceof Object&&Object.prototype.hasOwnProperty.call(h,"type")&&h.type.toString().startsWith(r.PREFIX)}$.isAppBridgeAction=d;function c(h){if(typeof h!="object"||!h.data||typeof h.data!="object")return!1;var v=h.data;return Object.prototype.hasOwnProperty.call(v,"type")&&l.findMatchInEnum(e.MessageType,v.type)!==void 0}$.isAppMessage=c;function o(h){var v=h.type;return v.match(/^APP::(PERFORMANCE|WEB_VITALS)::/)}$.isPerformanceOrWebVitalsAction=o;function p(h){return h.replace(new RegExp("^"+r.PREFIX+r.SEPARATOR+"\\w+"+r.SEPARATOR),"")}$.getPermissionKey=p;function g(h,v,u){var i=v.group,f=v.type;if(!i||!Object.prototype.hasOwnProperty.call(h,i))return!1;var n=h[i];if(!n)return!1;var a=p(f);return n[a]?n[a][u]===!0:!1}return $.isPermitted=g,$}var Ie={},ot;function Ge(){return ot||(ot=1,function(e){var r,l;Object.defineProperty(e,"__esModule",{value:!0}),e.isUnframed=e.isClient=e.isServer=void 0,e.isServer=typeof window>"u",e.isClient=!e.isServer,e.isUnframed=e.isClient&&((l=(r=window.navigator)===null||r===void 0?void 0:r.userAgent)===null||l===void 0?void 0:l.indexOf("Unframed"))>0}(Ie)),Ie}var ut;function zr(){return ut||(ut=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createTransportListener=e.fromWindow=e.fromFrame=e.Context=void 0;var r=Ae(),l=Wr(),d=We(),c=Dt(),o=Ge();(function(u){u.Modal="Modal",u.Main="Main"})(e.Context||(e.Context={}));function p(u,i,f){var n=[],a=u.host,t=u.window;if(!a)throw r.fromAction("App frame is undefined",r.AppActionType.WINDOW_UNDEFINED);return o.isUnframed&&window.MobileWebView&&Object.assign(window.MobileWebView,{postMessageToIframe:function(s,y){t==null||t.postMessage(s,y),v(s)&&a.postMessage(JSON.stringify(s.payload),location.origin)},updateIframeUrl:function(s){var y=window.location,b=(u.window||{}).location;try{var _=new URL(s).origin;_===i&&b?b.replace(s):y.href=s}catch{}}}),a.addEventListener("message",function(s){if(!(s.source===a||!l.isAppMessage(s))){if(s.origin!==i){var y="Message origin '"+s.origin+"' does not match app origin '"+i+"'.",b=r.invalidOriginAction(y),_={type:"dispatch",payload:b};t==null||t.postMessage(_,s.origin);return}if(o.isUnframed&&window.MobileWebView){var b=JSON.stringify({id:"unframed://fromClient",origin:i,data:s.data});window.MobileWebView.postMessage(b);return}for(var P=0,T=n;P<T.length;P++){var S=T[P];S(s)}}}),{context:f,localOrigin:i,frameWindow:t,hostFrame:a,dispatch:function(s){t==null||t.postMessage(s,i)},subscribe:function(s){return c.addAndRemoveFromCollection(n,s)}}}e.fromFrame=p;function g(u,i){var f=[];return typeof window!==void 0&&window.addEventListener("message",function(n){if(!(window===u&&!o.isUnframed||n.source!==u||!(l.isAppBridgeAction(n.data.payload)||l.isAppMessage(n))))for(var a=0,t=f;a<t.length;a++){var s=t[a];s(n)}}),{localOrigin:i,hostFrame:u,dispatch:function(n){var a;if(!((a=n.source)===null||a===void 0)&&a.host){if(o.isUnframed&&window&&window.MobileWebView){var t=JSON.stringify({id:"unframed://fromClient",origin:i,data:n});window.MobileWebView.postMessage(t);return}var s=new URL("https://"+n.source.host).origin;u.postMessage(n,s)}},subscribe:function(n){return c.addAndRemoveFromCollection(f,n)}}}e.fromWindow=g;function h(){var u=[],i={};function f(n){function a(){if(arguments.length<2)return c.addAndRemoveFromCollection(u,{callback:arguments[0]});var t=Array.from(arguments),s=t[0],y=t[1],b=t[2],_={callback:y,id:b},P={type:s,id:b};return Object.prototype.hasOwnProperty.call(i,s)||(i[s]=[]),n&&n(d.MessageType.Subscribe,P),c.addAndRemoveFromCollection(i[s],_,function(){n&&n(d.MessageType.Unsubscribe,P)})}return a}return{createSubscribeHandler:f,handleMessage:function(n){u.forEach(function(a){return a.callback(n)})},handleActionDispatch:function(n){var a=n.type,t=n.payload,s=!1;if(Object.prototype.hasOwnProperty.call(i,a))for(var y=0,b=i[a];y<b.length;y++){var _=b[y],P=_.id,T=_.callback,S=t&&t.id===P;(S||!P)&&(T(t),s=!0)}return s}}}e.createTransportListener=h;function v(u){return u!==null&&typeof u=="object"&&!Array.isArray(u)&&u.type==="dispatch"&&typeof u.payload=="object"}}(Te)),Te}var st;function Vr(){return st||(st=1,function(e){var r=oe&&oe.__createBinding||(Object.create?function(d,c,o,p){p===void 0&&(p=o),Object.defineProperty(d,p,{enumerable:!0,get:function(){return c[o]}})}:function(d,c,o,p){p===void 0&&(p=o),d[p]=c[o]}),l=oe&&oe.__exportStar||function(d,c){for(var o in d)o!=="default"&&!Object.prototype.hasOwnProperty.call(c,o)&&r(c,d,o)};Object.defineProperty(e,"__esModule",{value:!0}),l(zr(),e)}(oe)),oe}var G={},Re={},ct;function Hr(){return ct||(ct=1,function(e){var r={};Object.defineProperty(e,"__esModule",{value:!0}),e.isDevelopmentClient=e.isProduction=e.isDevelopment=e.isUnframed=e.isServer=e.isClient=void 0;var l=Ge(),d=Ge();Object.defineProperty(e,"isClient",{enumerable:!0,get:function(){return d.isClient}}),Object.defineProperty(e,"isServer",{enumerable:!0,get:function(){return d.isServer}}),Object.defineProperty(e,"isUnframed",{enumerable:!0,get:function(){return d.isUnframed}}),e.isDevelopment=typeof process<"u"&&r&&!0,e.isProduction=!e.isDevelopment,e.isDevelopmentClient=e.isDevelopment&&l.isClient}(Re)),Re}var lt;function Ft(){if(lt)return G;lt=1,Object.defineProperty(G,"__esModule",{value:!0}),G.isShopifyPing=G.isShopifyPOS=G.isShopifyMobile=G.isShopifyEmbedded=G.isMobile=void 0;var e=Hr();function r(){return d()||c()||o()}G.isMobile=r;function l(){return e.isClient&&window.top!==window.self||e.isUnframed}G.isShopifyEmbedded=l;function d(){return typeof navigator<"u"&&navigator.userAgent.indexOf("Shopify Mobile")>=0}G.isShopifyMobile=d;function c(){return typeof navigator<"u"&&navigator.userAgent.indexOf("Shopify POS")>=0}G.isShopifyPOS=c;function o(){return typeof navigator<"u"&&navigator.userAgent.indexOf("Shopify Ping")>=0}return G.isShopifyPing=o,G}var dt;function Kr(){if(dt)return W;dt=1;var e=W&&W.__awaiter||function(i,f,n,a){function t(s){return s instanceof n?s:new n(function(y){y(s)})}return new(n||(n=Promise))(function(s,y){function b(T){try{P(a.next(T))}catch(S){y(S)}}function _(T){try{P(a.throw(T))}catch(S){y(S)}}function P(T){T.done?s(T.value):t(T.value).then(b,_)}P((a=a.apply(i,f||[])).next())})},r=W&&W.__generator||function(i,f){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},a,t,s,y;return y={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function b(P){return function(T){return _([P,T])}}function _(P){if(a)throw new TypeError("Generator is already executing.");for(;n;)try{if(a=1,t&&(s=P[0]&2?t.return:P[0]?t.throw||((s=t.return)&&s.call(t),0):t.next)&&!(s=s.call(t,P[1])).done)return s;switch(t=0,s&&(P=[P[0]&2,s.value]),P[0]){case 0:case 1:s=P;break;case 4:return n.label++,{value:P[1],done:!1};case 5:n.label++,t=P[1],P=[0];continue;case 7:P=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(P[0]===6||P[0]===2)){n=0;continue}if(P[0]===3&&(!s||P[1]>s[0]&&P[1]<s[3])){n.label=P[1];break}if(P[0]===6&&n.label<s[1]){n.label=s[1],s=P;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(P);break}s[2]&&n.ops.pop(),n.trys.pop();continue}P=f.call(i,n)}catch(T){P=[6,T],t=0}finally{a=s=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}};Object.defineProperty(W,"__esModule",{value:!0}),W.createMutationObserver=W.setupModalAutoSizing=void 0;var l=Gr(),d=Vr(),c=Ft(),o="app-bridge-utils-modal-auto-size",p=g();function g(){if(typeof document>"u")return null;var i=document.createElement("style");return i.type="text/css",i.innerHTML="."+o+" { overflow: hidden; height: auto; min-height: auto; }",i}function h(i,f){if(!p)return function(){};var n=document.getElementsByTagName("head")[0],a=document.body.classList;n.appendChild(p),a.add(o);var t=u(i,f);return function(){a.remove(o),n.contains(p)&&n.removeChild(p),t&&t.disconnect()}}function v(i){return e(this,void 0,void 0,function(){function f(){a&&(a(),a=void 0)}function n(t){var s=t.context,y=t.modal.id;return c.isMobile()||s!==d.Context.Modal?(f(),f):(a||(a=h(i,y)),f)}var a;return r(this,function(t){switch(t.label){case 0:return[4,i.getState().then(n)];case 1:return t.sent(),[2,f]}})})}W.setupModalAutoSizing=v;function u(i,f){if(typeof document>"u")return;var n=-1,a,t={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},s=new MutationObserver(y);s.observe(document,t),b();function y(){a&&window.clearTimeout(a),a=window.setTimeout(b,16)}function b(){var _=document.body.scrollHeight;_!==n&&(n=_,i.dispatch(l.updateModalSize({id:f,height:String(_)})))}return s}return W.createMutationObserver=u,W}var ue={},q={},Ne={},je={},ft;function Xr(){return ft||(ft=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.respond=e.request=e.Action=void 0;var r=Q(),l=Z(),d;(function(p){p.REQUEST="APP::SESSION_TOKEN::REQUEST",p.RESPOND="APP::SESSION_TOKEN::RESPOND"})(d=e.Action||(e.Action={}));function c(){return r.actionWrapper({group:l.Group.SessionToken,type:d.REQUEST})}e.request=c;function o(p){return r.actionWrapper({payload:p,group:l.Group.SessionToken,type:d.RESPOND})}e.respond=o}(je)),je}var pt;function Jr(){return pt||(pt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.respond=e.request=e.Action=void 0;var r=Xr();Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return r.Action}}),Object.defineProperty(e,"request",{enumerable:!0,get:function(){return r.request}}),Object.defineProperty(e,"respond",{enumerable:!0,get:function(){return r.respond}})}(Ne)),Ne}var De={},ke={};const Yr="@shopify/app-bridge",Zr="3.7.10",Qr={name:Yr,version:Zr};var ht;function Bt(){return ht||(ht=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getPackageName=e.getVersion=e.getMergedProps=e.updateActionFromPayload=e.isValidOptionalString=e.isValidOptionalNumber=e.NonSnakeCaseGroup=e.getEventNameSpace=e.forEachInEnum=e.findMatchInEnum=e.actionWrapper=void 0;var r=Q();Object.defineProperty(e,"actionWrapper",{enumerable:!0,get:function(){return r.actionWrapper}}),Object.defineProperty(e,"findMatchInEnum",{enumerable:!0,get:function(){return r.findMatchInEnum}}),Object.defineProperty(e,"forEachInEnum",{enumerable:!0,get:function(){return r.forEachInEnum}}),Object.defineProperty(e,"getEventNameSpace",{enumerable:!0,get:function(){return r.getEventNameSpace}}),Object.defineProperty(e,"NonSnakeCaseGroup",{enumerable:!0,get:function(){return r.NonSnakeCaseGroup}}),Object.defineProperty(e,"isValidOptionalNumber",{enumerable:!0,get:function(){return r.isValidOptionalNumber}}),Object.defineProperty(e,"isValidOptionalString",{enumerable:!0,get:function(){return r.isValidOptionalString}}),Object.defineProperty(e,"updateActionFromPayload",{enumerable:!0,get:function(){return r.updateActionFromPayload}}),Object.defineProperty(e,"getMergedProps",{enumerable:!0,get:function(){return r.getMergedProps}});var l=Qr;function d(){return l.version}e.getVersion=d;function c(){return l.name}e.getPackageName=c}(ke)),ke}var Ue={},yt;function qt(){return yt||(yt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ComponentType=e.Group=void 0;var r=Z();Object.defineProperty(e,"Group",{enumerable:!0,get:function(){return r.Group}}),Object.defineProperty(e,"ComponentType",{enumerable:!0,get:function(){return r.ComponentType}})}(Ue)),Ue}var mt;function $t(){return mt||(mt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.networkAction=e.persistenceAction=e.unsupportedOperationAction=e.unexpectedAction=e.invalidAction=e.invalidActionType=e.invalidPayload=e.Message=e.fromAction=e.Action=e.permissionAction=e.isErrorEventName=e.throwError=e.invalidOriginAction=e.AppBridgeError=e.AppActionType=void 0;var r=Ae();Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return r.Action}}),Object.defineProperty(e,"fromAction",{enumerable:!0,get:function(){return r.fromAction}});var l=Bt(),d=qt(),c=Ae();Object.defineProperty(e,"AppActionType",{enumerable:!0,get:function(){return c.AppActionType}}),Object.defineProperty(e,"AppBridgeError",{enumerable:!0,get:function(){return c.AppBridgeError}}),Object.defineProperty(e,"invalidOriginAction",{enumerable:!0,get:function(){return c.invalidOriginAction}}),Object.defineProperty(e,"throwError",{enumerable:!0,get:function(){return c.throwError}}),Object.defineProperty(e,"isErrorEventName",{enumerable:!0,get:function(){return c.isErrorEventName}}),Object.defineProperty(e,"permissionAction",{enumerable:!0,get:function(){return c.permissionAction}});function o(n,a,t){var s=a.payload;return l.actionWrapper({type:n,group:d.Group.Error,payload:{action:a,message:t,type:n,id:s&&s.id?s.id:void 0}})}(function(n){n.MISSING_PAYLOAD="Missing payload",n.INVALID_PAYLOAD_ID="Id in payload is missing or invalid"})(e.Message||(e.Message={}));function p(n,a){return o(r.Action.INVALID_PAYLOAD,n,a||"The action's payload is missing required properties or has invalid properties")}e.invalidPayload=p;function g(n,a){return l.actionWrapper({group:d.Group.Error,payload:{action:n,message:a||"The action type is invalid or unsupported",type:r.Action.INVALID_ACTION_TYPE},type:r.Action.INVALID_ACTION_TYPE})}e.invalidActionType=g;function h(n,a){return l.actionWrapper({group:d.Group.Error,payload:{action:n,message:a||"The action's has missing/invalid values for `group`, `type` or `version`",type:r.Action.INVALID_ACTION},type:r.Action.INVALID_ACTION})}e.invalidAction=h;function v(n,a){return l.actionWrapper({group:d.Group.Error,payload:{action:n,message:a||"Action cannot be called at this time",type:r.Action.UNEXPECTED_ACTION},type:r.Action.UNEXPECTED_ACTION})}e.unexpectedAction=v;function u(n,a){return o(r.Action.UNSUPPORTED_OPERATION,n,a||"The action type is unsupported")}e.unsupportedOperationAction=u;function i(n,a){return o(r.Action.PERSISTENCE,n,a||"Action cannot be persisted on server")}e.persistenceAction=i;function f(n,a){return o(r.Action.NETWORK,n,a||"Network error")}e.networkAction=f}(De)),De}var gt;function Gt(){if(gt)return q;gt=1;var e=q&&q.__createBinding||(Object.create?function(h,v,u,i){i===void 0&&(i=u),Object.defineProperty(h,i,{enumerable:!0,get:function(){return v[u]}})}:function(h,v,u,i){i===void 0&&(i=u),h[i]=v[u]}),r=q&&q.__setModuleDefault||(Object.create?function(h,v){Object.defineProperty(h,"default",{enumerable:!0,value:v})}:function(h,v){h.default=v}),l=q&&q.__importStar||function(h){if(h&&h.__esModule)return h;var v={};if(h!=null)for(var u in h)u!=="default"&&Object.prototype.hasOwnProperty.call(h,u)&&e(v,h,u);return r(v,h),v},d=q&&q.__awaiter||function(h,v,u,i){function f(n){return n instanceof u?n:new u(function(a){a(n)})}return new(u||(u=Promise))(function(n,a){function t(b){try{y(i.next(b))}catch(_){a(_)}}function s(b){try{y(i.throw(b))}catch(_){a(_)}}function y(b){b.done?n(b.value):f(b.value).then(t,s)}y((i=i.apply(h,v||[])).next())})},c=q&&q.__generator||function(h,v){var u={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,f,n,a;return a={next:t(0),throw:t(1),return:t(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function t(y){return function(b){return s([y,b])}}function s(y){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,f&&(n=y[0]&2?f.return:y[0]?f.throw||((n=f.return)&&n.call(f),0):f.next)&&!(n=n.call(f,y[1])).done)return n;switch(f=0,n&&(y=[y[0]&2,n.value]),y[0]){case 0:case 1:n=y;break;case 4:return u.label++,{value:y[1],done:!1};case 5:u.label++,f=y[1],y=[0];continue;case 7:y=u.ops.pop(),u.trys.pop();continue;default:if(n=u.trys,!(n=n.length>0&&n[n.length-1])&&(y[0]===6||y[0]===2)){u=0;continue}if(y[0]===3&&(!n||y[1]>n[0]&&y[1]<n[3])){u.label=y[1];break}if(y[0]===6&&u.label<n[1]){u.label=n[1],n=y;break}if(n&&u.label<n[2]){u.label=n[2],u.ops.push(y);break}n[2]&&u.ops.pop(),u.trys.pop();continue}y=v.call(h,u)}catch(b){y=[6,b],f=0}finally{i=n=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(q,"__esModule",{value:!0}),q.getSessionToken=void 0;var o=l(Jr()),p=$t();function g(h){return d(this,void 0,void 0,function(){return c(this,function(v){return[2,new Promise(function(u,i){var f=h.subscribe(o.Action.RESPOND,function(n){var a=n.sessionToken;a?u(a):i(p.fromAction("Failed to retrieve a session token",p.Action.FAILED_AUTHENTICATION)),f()});h.dispatch(o.request())})]})})}return q.getSessionToken=g,q}var z={},vt;function xr(){if(vt)return z;vt=1;var e=z&&z.__assign||function(){return e=Object.assign||function(o){for(var p,g=1,h=arguments.length;g<h;g++){p=arguments[g];for(var v in p)Object.prototype.hasOwnProperty.call(p,v)&&(o[v]=p[v])}return o},e.apply(this,arguments)},r=z&&z.__awaiter||function(o,p,g,h){function v(u){return u instanceof g?u:new g(function(i){i(u)})}return new(g||(g=Promise))(function(u,i){function f(t){try{a(h.next(t))}catch(s){i(s)}}function n(t){try{a(h.throw(t))}catch(s){i(s)}}function a(t){t.done?u(t.value):v(t.value).then(f,n)}a((h=h.apply(o,p||[])).next())})},l=z&&z.__generator||function(o,p){var g={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},h,v,u,i;return i={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function f(a){return function(t){return n([a,t])}}function n(a){if(h)throw new TypeError("Generator is already executing.");for(;g;)try{if(h=1,v&&(u=a[0]&2?v.return:a[0]?v.throw||((u=v.return)&&u.call(v),0):v.next)&&!(u=u.call(v,a[1])).done)return u;switch(v=0,u&&(a=[a[0]&2,u.value]),a[0]){case 0:case 1:u=a;break;case 4:return g.label++,{value:a[1],done:!1};case 5:g.label++,v=a[1],a=[0];continue;case 7:a=g.ops.pop(),g.trys.pop();continue;default:if(u=g.trys,!(u=u.length>0&&u[u.length-1])&&(a[0]===6||a[0]===2)){g=0;continue}if(a[0]===3&&(!u||a[1]>u[0]&&a[1]<u[3])){g.label=a[1];break}if(a[0]===6&&g.label<u[1]){g.label=u[1],u=a;break}if(u&&g.label<u[2]){g.label=u[2],g.ops.push(a);break}u[2]&&g.ops.pop(),g.trys.pop();continue}a=p.call(o,g)}catch(t){a=[6,t],v=0}finally{h=u=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(z,"__esModule",{value:!0}),z.authenticatedFetch=void 0;var d=Gt();function c(o,p){var g=this;return p===void 0&&(p=fetch),function(h,v){return v===void 0&&(v={}),r(g,void 0,void 0,function(){var u,i,f;return l(this,function(n){switch(n.label){case 0:return[4,d.getSessionToken(o)];case 1:return u=n.sent(),i=new Headers(v.headers),i.append("Authorization","Bearer "+u),i.append("X-Requested-With","XMLHttpRequest"),f={},i.forEach(function(a,t){f[t]=a}),[2,p(h,e(e({},v),{headers:f}))]}})})}}return z.authenticatedFetch=c,z}var bt;function en(){return bt||(bt=1,function(e){var r=ue&&ue.__createBinding||(Object.create?function(d,c,o,p){p===void 0&&(p=o),Object.defineProperty(d,p,{enumerable:!0,get:function(){return c[o]}})}:function(d,c,o,p){p===void 0&&(p=o),d[p]=c[o]}),l=ue&&ue.__exportStar||function(d,c){for(var o in d)o!=="default"&&!Object.prototype.hasOwnProperty.call(c,o)&&r(c,d,o)};Object.defineProperty(e,"__esModule",{value:!0}),l(Gt(),e),l(xr(),e)}(ue)),ue}var se={},L={},Le={},Fe={},_t;function At(){return _t||(_t=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.respond=e.Action=void 0;var r=Q(),l=Z(),d;(function(o){o.REQUEST="APP::AUTH_CODE::REQUEST",o.RESPOND="APP::AUTH_CODE::RESPOND"})(d=e.Action||(e.Action={}));function c(o){return r.actionWrapper({payload:o,group:l.Group.AuthCode,type:d.RESPOND})}e.respond=c}(Fe)),Fe}var Ot;function tn(){return Ot||(Ot=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.request=e.Action=e.respond=void 0;var r=At();Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return r.Action}});var l=Bt(),d=qt(),c=At();Object.defineProperty(e,"respond",{enumerable:!0,get:function(){return c.respond}});function o(p){return l.actionWrapper({group:d.Group.AuthCode,type:r.Action.REQUEST,payload:{id:p}})}e.request=o}(Le)),Le}var Be={},Pt;function rn(){return Pt||(Pt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.generateUuid=void 0;var r=kt();Object.defineProperty(e,"generateUuid",{enumerable:!0,get:function(){return r.generateUuid}}),e.default=r.generateUuid}(Be)),Be}var Et;function Wt(){if(Et)return L;Et=1;var e=L&&L.__createBinding||(Object.create?function(u,i,f,n){n===void 0&&(n=f),Object.defineProperty(u,n,{enumerable:!0,get:function(){return i[f]}})}:function(u,i,f,n){n===void 0&&(n=f),u[n]=i[f]}),r=L&&L.__setModuleDefault||(Object.create?function(u,i){Object.defineProperty(u,"default",{enumerable:!0,value:i})}:function(u,i){u.default=i}),l=L&&L.__importStar||function(u){if(u&&u.__esModule)return u;var i={};if(u!=null)for(var f in u)f!=="default"&&Object.prototype.hasOwnProperty.call(u,f)&&e(i,u,f);return r(i,u),i},d=L&&L.__awaiter||function(u,i,f,n){function a(t){return t instanceof f?t:new f(function(s){s(t)})}return new(f||(f=Promise))(function(t,s){function y(P){try{_(n.next(P))}catch(T){s(T)}}function b(P){try{_(n.throw(P))}catch(T){s(T)}}function _(P){P.done?t(P.value):a(P.value).then(y,b)}_((n=n.apply(u,i||[])).next())})},c=L&&L.__generator||function(u,i){var f={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},n,a,t,s;return s={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function y(_){return function(P){return b([_,P])}}function b(_){if(n)throw new TypeError("Generator is already executing.");for(;f;)try{if(n=1,a&&(t=_[0]&2?a.return:_[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,_[1])).done)return t;switch(a=0,t&&(_=[_[0]&2,t.value]),_[0]){case 0:case 1:t=_;break;case 4:return f.label++,{value:_[1],done:!1};case 5:f.label++,a=_[1],_=[0];continue;case 7:_=f.ops.pop(),f.trys.pop();continue;default:if(t=f.trys,!(t=t.length>0&&t[t.length-1])&&(_[0]===6||_[0]===2)){f=0;continue}if(_[0]===3&&(!t||_[1]>t[0]&&_[1]<t[3])){f.label=_[1];break}if(_[0]===6&&f.label<t[1]){f.label=t[1],t=_;break}if(t&&f.label<t[2]){f.label=t[2],f.ops.push(_);break}t[2]&&f.ops.pop(),f.trys.pop();continue}_=i.call(u,f)}catch(P){_=[6,P],a=0}finally{n=t=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},o=L&&L.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(L,"__esModule",{value:!0}),L.getAuthorizationCodePayload=void 0;var p=l(tn()),g=$t(),h=o(rn());function v(u){return d(this,void 0,void 0,function(){return c(this,function(i){return[2,new Promise(function(f,n){var a=h.default(),t=u.subscribe(p.Action.RESPOND,function(s){switch(s==null?void 0:s.status){case"needsExchange":f(s);break;default:n(g.fromAction("Failed to retrieve an authorization code",g.Action.FAILED_AUTHENTICATION))}t()},a);u.dispatch(p.request(a))})]})})}return L.getAuthorizationCodePayload=v,L}var K={},St;function nn(){if(St)return K;St=1;var e=K&&K.__awaiter||function(p,g,h,v){function u(i){return i instanceof h?i:new h(function(f){f(i)})}return new(h||(h=Promise))(function(i,f){function n(s){try{t(v.next(s))}catch(y){f(y)}}function a(s){try{t(v.throw(s))}catch(y){f(y)}}function t(s){s.done?i(s.value):u(s.value).then(n,a)}t((v=v.apply(p,g||[])).next())})},r=K&&K.__generator||function(p,g){var h={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},v,u,i,f;return f={next:n(0),throw:n(1),return:n(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function n(t){return function(s){return a([t,s])}}function a(t){if(v)throw new TypeError("Generator is already executing.");for(;h;)try{if(v=1,u&&(i=t[0]&2?u.return:t[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,t[1])).done)return i;switch(u=0,i&&(t=[t[0]&2,i.value]),t[0]){case 0:case 1:i=t;break;case 4:return h.label++,{value:t[1],done:!1};case 5:h.label++,u=t[1],t=[0];continue;case 7:t=h.ops.pop(),h.trys.pop();continue;default:if(i=h.trys,!(i=i.length>0&&i[i.length-1])&&(t[0]===6||t[0]===2)){h=0;continue}if(t[0]===3&&(!i||t[1]>i[0]&&t[1]<i[3])){h.label=t[1];break}if(t[0]===6&&h.label<i[1]){h.label=i[1],i=t;break}if(i&&h.label<i[2]){h.label=i[2],h.ops.push(t);break}i[2]&&h.ops.pop(),h.trys.pop();continue}t=g.call(p,h)}catch(s){t=[6,s],u=0}finally{v=i=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};Object.defineProperty(K,"__esModule",{value:!0}),K.userAuthorizedFetch=void 0;var l=Wt(),d="auth/shopify/callback";function c(p){var g=p.headers.get("X-Shopify-API-Request-Failure-Unauthorized");return g?g.toLowerCase()==="true":!1}function o(p){var g=this,h=p.app,v=p.callbackUri,u=v===void 0?d:v,i=p.isAuthorizationCodeRequired,f=i===void 0?c:i,n=p.fetchOperation;return function(a,t){return e(g,void 0,void 0,function(){var s,y,b,_,P,T,S,I;return r(this,function(M){switch(M.label){case 0:return[4,n(a,t)];case 1:return s=M.sent(),f(s)?[4,l.getAuthorizationCodePayload(h)]:[2,s];case 2:return y=M.sent(),b=y.code,_=y.hmac,P=y.shop,T=y.timestamp,S=encodeURI("https://"+window.location.hostname+"/"+u+"?code="+b+"&hmac="+_+"&shop="+P+"&timestamp="+T),[4,n(S,{})];case 3:if(I=M.sent(),!I.ok)throw new Error("Failed to authorize request.");return[2,n(a,t)]}})})}}return K.userAuthorizedFetch=o,K}var wt;function an(){return wt||(wt=1,function(e){var r=se&&se.__createBinding||(Object.create?function(d,c,o,p){p===void 0&&(p=o),Object.defineProperty(d,p,{enumerable:!0,get:function(){return c[o]}})}:function(d,c,o,p){p===void 0&&(p=o),d[p]=c[o]}),l=se&&se.__exportStar||function(d,c){for(var o in d)o!=="default"&&!Object.prototype.hasOwnProperty.call(c,o)&&r(c,d,o)};Object.defineProperty(e,"__esModule",{value:!0}),l(Wt(),e),l(nn(),e)}(se)),se}var Ct;function on(){return Ct||(Ct=1,function(e){var r=te&&te.__createBinding||(Object.create?function(d,c,o,p){p===void 0&&(p=o),Object.defineProperty(d,p,{enumerable:!0,get:function(){return c[o]}})}:function(d,c,o,p){p===void 0&&(p=o),d[p]=c[o]}),l=te&&te.__exportStar||function(d,c){for(var o in d)o!=="default"&&!Object.prototype.hasOwnProperty.call(c,o)&&r(c,d,o)};Object.defineProperty(e,"__esModule",{value:!0}),l(Kr(),e),l(Ft(),e),l(en(),e),l(an(),e)}(te)),te}var Mt;function un(){return Mt||(Mt=1,function(e){var r=ee&&ee.__createBinding||(Object.create?function(d,c,o,p){p===void 0&&(p=o),Object.defineProperty(d,p,{enumerable:!0,get:function(){return c[o]}})}:function(d,c,o,p){p===void 0&&(p=o),d[p]=c[o]}),l=ee&&ee.__exportStar||function(d,c){for(var o in d)o!=="default"&&!Object.prototype.hasOwnProperty.call(c,o)&&r(c,d,o)};Object.defineProperty(e,"__esModule",{value:!0}),l(on(),e)}(ee)),ee}var sn=un();const zt=C.createContext(null),cn=[],ln={appearingRules:{exitIntent:{enabled:!1,device:"desktop"},timeDelay:{enabled:!1,seconds:5},pageScroll:{enabled:!1,percentage:20},pageCount:{enabled:!1,pages:2},clicksCount:{enabled:!1,clicks:2},inactivity:{enabled:!1,seconds:30}},pageTargeting:{enabled:!0,url:"www.yourdomain.com",urls:[]},popupAgain:{enabled:!0,timer:{minutes:10,seconds:0}},displayFrequency:{enabled:!0,frequency:"once_a_day",visitorType:"everyone"}};function gn({children:e}){const r=Jt(),l=sn.authenticatedFetch(r),{currentPlan:d}=Xt(),[c,o]=C.useState({connected:!1,checking:!0});Yt();const[p,g]=C.useState({name:"wheel-of-wonders",formatted:"wheel-of-wonders"}),[h,v]=C.useState(!1),[u,i]=C.useState({name:"Campaign Name",step:1,look:"custom",color:"singleTone",primaryColor:"#fe5300",secondaryColor:"#767676",tertiaryColor:"#444444",completionPercentage:25,rules:ln,shop:"wheel-of-wonders"}),[f,n]=C.useState(cn),[a,t]=C.useState(!0),s=async E=>{const m=E.headers.get("content-type");if(!m||!m.includes("application/json"))return null;try{return await E.json()}catch{return null}},y=()=>{try{let m=new URLSearchParams(window.location.search).get("shop");if(m)return m;try{const O=window.location.hash;if(O&&(m=new URLSearchParams(O.substring(1)).get("shop"),m))return m}catch{}try{if(m=localStorage.getItem("shopify_shop_domain"),m)return m}catch{}if(window.shopOrigin)return m=window.shopOrigin,m;try{if(window.shopify&&window.shopify.config&&window.shopify.config.shop)return m=window.shopify.config.shop,m}catch{}const A=window.location.hostname;if(A.includes(".myshopify.com"))return m=A,m;try{const O=document.referrer;if(O&&O.includes(".myshopify.com")){const w=new URL(O);if(w.hostname.includes(".myshopify.com"))return m=w.hostname,m}}catch{}return null}catch{return null}};C.useEffect(()=>{(async()=>{try{const m=y();if(m){const A=m.replace(/\.myshopify\.com$/i,"");g({name:m,formatted:A});try{localStorage.setItem("shopify_shop_domain",m)}catch{}i(O=>({...O,shop:m}))}try{const A=await fetch("/",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});if(A.ok){const O=await s(A);if(O&&O.shop){const w=O.shop,k=w.replace(/\.myshopify\.com$/i,"");g({name:w,formatted:k});try{localStorage.setItem("shopify_shop_domain",w)}catch{}i(fe=>({...fe,shop:w})),v(!1);return}}else A.status}catch{}try{const A=await fetch("/api/db-status",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});if(A.ok){const O=await s(A);if(O&&O.shop){const w=O.shop,k=w.replace(/\.myshopify\.com$/i,"");g({name:w,formatted:k});try{localStorage.setItem("shopify_shop_domain",w)}catch{}i(fe=>({...fe,shop:w})),v(!1);return}}}catch{}v(!m)}catch{const A=y();if(A){const O=A.replace(/\.myshopify\.com$/i,"");g({name:A,formatted:O}),i(w=>({...w,shop:A})),v(!1)}else v(!0)}})()},[]),C.useEffect(()=>{(async()=>{try{const m=await fetch("/api/db-status",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});if(!m.ok)throw new Error(`HTTP error! Status: ${m.status}`);const A=await s(m);if(!A)throw new Error("Invalid JSON response from db-status");if(o({connected:A.connected,checking:!1,error:A.error,dbName:A.dbName,shop:A.shop}),A.shop){const O=A.shop.replace(/\.myshopify\.com$/i,"");g({name:A.shop,formatted:O});try{localStorage.setItem("shopify_shop_domain",A.shop)}catch{}i(w=>({...w,shop:A.shop}))}}catch(m){o({connected:!1,checking:!1,error:m.message})}})()},[]),C.useEffect(()=>{(async()=>{if(c.checking||!c.connected){t(!1);return}try{t(!0);const m=await fetch("/api/campaigns",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});if(!m.ok)throw new Error(`HTTP error! Status: ${m.status}`);const A=await s(m);if(!A)throw new Error("Invalid JSON response from campaigns API");const O=A.campaigns||A;if(Array.isArray(O)&&O.length>0&&(n(O),A.shop)){const w=A.shop.replace(/\.myshopify\.com$/i,"");g({name:A.shop,formatted:w})}}catch{}finally{t(!1)}})()},[c]);const b=C.useCallback(E=>{i(m=>({...m,...E}))},[]),_=C.useCallback(E=>{i(m=>({...m,name:E||"Campaign Name"})),R.success("Campaign name updated!")},[]),P=C.useCallback(E=>{i(m=>({...m,look:E})),R.success(`Look updated to ${E}!`)},[]),T=C.useCallback(E=>{i(m=>({...m,color:E})),R.success(`Color type updated to ${E}!`)},[]),S=C.useCallback((E,m)=>{i(A=>{const O={...A};return E==="primary"?O.primaryColor=m:E==="secondary"?O.secondaryColor=m:E==="tertiary"&&(O.tertiaryColor=m),O}),R.success(`${E} color updated!`)},[]),I=C.useCallback((E,m)=>{i(A=>{const O=A.rules||{},w=O[E]?{...O[E]}:{},k={...O,[E]:{...w,...m}};return{...A,rules:k}})},[]),M=C.useCallback((E,m=null)=>{i(O=>{const w={...O.rules};return m?w[E]={...w[E],[m]:{...w[E][m],enabled:!w[E][m].enabled}}:w[E]={...w[E],enabled:!w[E].enabled},{...O,rules:w}});const A=m||E;R.success(`${A.charAt(0).toUpperCase()+A.slice(1)} ${m?"rule":""} toggled!`)},[]),N=C.useCallback((E,m,A,O)=>{i(w=>{const k={...w.rules};return k[E]={...k[E],[m]:{...k[E][m],[A]:O}},{...w,rules:k}})},[]),j=C.useCallback(E=>{E&&(i(m=>{if(m.rules.pageTargeting.urls.includes(E))return m;const A={...m.rules.pageTargeting,urls:[...m.rules.pageTargeting.urls,E]};return{...m,rules:{...m.rules,pageTargeting:A}}}),R.success(`URL "${E}" added to page targeting!`))},[]),D=C.useCallback(E=>{i(m=>{const A=m.rules.pageTargeting.urls.filter(O=>O!==E);return{...m,rules:{...m.rules,pageTargeting:{...m.rules.pageTargeting,urls:A}}}}),R.success(`URL "${E}" removed from page targeting!`)},[]),F=C.useCallback(()=>{i(E=>{const m=Math.min(4,E.step+1),A=Math.min(100,m/4*100);return{...E,step:m,completionPercentage:A}}),R.success("Moving to next step!")},[]),B=C.useCallback(()=>{i(E=>{const m=Math.max(1,E.step-1),A=Math.max(25,m/4*100);return{...E,step:m,completionPercentage:A}}),R.success("Moving to previous step!")},[]),x=C.useCallback(()=>f.length<d.campaignLimit,[f.length,d.campaignLimit]),V=C.useCallback(async E=>{const m=f.filter(A=>A.id!==E&&A.status==="active");if(m.length!==0){if(c.connected)for(const A of m)try{await fetch(`/api/campaigns/${A.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...A,status:"draft"})})}catch{}n(A=>A.map(O=>O.id!==E&&O.status==="active"?{...O,status:"draft"}:O)),m.length>0&&R.success(`Deactivated ${m.length} other campaign(s)`)}},[f,c.connected]),Pe=C.useCallback(async E=>{let m;try{if(m={...E,id:E.id||`campaign-${Date.now()}`,name:E.name||"Campaign Name",createdAt:E.createdAt||new Date().toISOString(),status:E.status||"draft",primaryColor:E.primaryColor||"#fe5300",secondaryColor:E.secondaryColor||"#767676",tertiaryColor:E.tertiaryColor||"#444444",look:E.look||"custom",color:E.color||"singleTone",rules:E.rules||u.rules||{appearingRules:{exitIntent:{enabled:!0,device:"desktop"},timeDelay:{enabled:!0,seconds:5},pageScroll:{enabled:!0,percentage:20},pageCount:{enabled:!1,pages:2},clicksCount:{enabled:!1,clicks:2},inactivity:{enabled:!1,seconds:30}},pageTargeting:{enabled:!0,url:"www.yourdomain.com",urls:[]},popupAgain:{enabled:!0,timer:{minutes:10,seconds:0}},displayFrequency:{enabled:!0,frequency:"once_a_day",visitorType:"everyone"}},shop:p.name||E.shop||"wheel-of-wonders.myshopify.com"},m.status==="active"&&await V(m.id),c.connected)if(f.findIndex(O=>O.id===m.id)>=0){const O=await fetch(`/api/campaigns/${m.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(m)});if(!O.ok)throw new Error(`Failed to update campaign: ${O.statusText}`);const w=await O.json();if(w.shop){const k=w.shop.replace(/\.myshopify\.com$/i,"");g({name:w.shop,formatted:k})}}else{const O=await fetch("/api/campaigns",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(m)});if(!O.ok)throw new Error(`Failed to create campaign: ${O.statusText}`);const w=await O.json();if(w.shop){const k=w.shop.replace(/\.myshopify\.com$/i,"");g({name:w.shop,formatted:k})}}if(n(A=>A.findIndex(w=>w.id===m.id)>=0?A.map(w=>w.id===m.id?m:w):[...A,m]),i(A=>({...A,...m})),m.status==="active")try{(await l("/sync-campaign-metafields",{method:"POST",body:JSON.stringify({campaignId:m.id}),headers:{"Content-Type":"application/json"}})).ok?R.success("Campaign saved and synced to storefront!"):R.success("Campaign saved! Sync to storefront may take a moment.")}catch{R.success("Campaign saved! Sync to storefront may take a moment.")}else R.success("Campaign saved successfully!");return m}catch(A){R.error(`Failed to save campaign: ${A.message}`);const O=f.findIndex(w=>w.id===m.id);return n(w=>O>=0?w.map(k=>k.id===m.id?m:k):[...w,m]),m}},[f,u.rules,c.connected,p.name,V]),Ee=C.useCallback(async E=>{try{if(c.connected){const m=await fetch(`/api/campaigns/${E}`,{method:"DELETE"});if(!m.ok)throw new Error(`Failed to delete campaign: ${m.statusText}`)}return n(m=>m.filter(A=>A.id!==E)),R.success("Campaign deleted successfully!"),{success:!0}}catch(m){return R.error(`Failed to delete campaign: ${m.message}`),n(A=>A.filter(O=>O.id!==E)),{success:!0}}},[c.connected]),Vt=C.useCallback(async E=>{try{const m=f.find(O=>O.id===E);if(!m)throw new Error("Campaign not found");const A=m.status==="active"?"draft":"active";if(A==="active"&&await V(E),c.connected){const O=new FormData;O.append("status",A),O.append("shop",p.name||"");const w=await fetch(`/api/campaigns/status/${E}`,{method:"POST",credentials:"include",body:O});if(!w.ok)throw new Error(`Failed to toggle campaign status: ${w.statusText}`)}if(n(O=>O.map(w=>w.id===E?{...w,status:A}:w)),console.log("activated new campaign",A,E),A==="active")try{const O=await fetch("/api/sync-campaign-metafields",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({campaignId:E})});O.ok?R.success("Campaign activated and synced to storefront!"):(console.log("RELOADING PAGE not ok",O),R.success("Campaign activated! Sync to storefront may take a moment."))}catch(O){console.log("RELOADING PAGE",O),R.success("Campaign activated! Sync to storefront may take a moment.")}else try{(await fetch("/api/sync-campaign-metafields",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({campaignId:null,clear:!0})})).ok?R.success("Campaign deactivated and removed from storefront!"):R.success("Campaign deactivated!")}catch{R.success("Campaign deactivated!")}return{success:!0,status:A}}catch(m){R.error(`Failed to toggle campaign status: ${m.message}`);const A=f.find(O=>O.id===E);if(A){const O=A.status==="active"?"draft":"active";return n(O==="active"?w=>w.map(k=>k.id===E?{...k,status:O}:k.status==="active"?{...k,status:"draft"}:k):w=>w.map(k=>k.id===E?{...k,status:O}:k)),{success:!0,status:O}}return{success:!1}}},[f,c.connected,V,p.name]),Ht=C.useCallback(()=>f.find(E=>E.status==="active")||null,[f]);return Kt.jsx(zt.Provider,{value:{campaignData:u,allCampaigns:f,isLoading:a,dbStatus:c,shopInfo:p,isOfflineMode:h,updateCampaignData:b,updateCampaignName:_,updateLook:P,updateColor:T,updateColorValues:S,updateCampaignRules:I,toggleRuleEnabled:M,updateRuleValue:N,addPageTargetingUrl:j,removePageTargetingUrl:D,nextStep:F,prevStep:B,saveCampaign:Pe,deleteCampaign:Ee,toggleCampaignStatus:Vt,checkCanCreateCampaign:x,getActiveCampaign:Ht},children:e})}function vn(){const e=C.useContext(zt);if(!e)throw new Error("useCampaign must be used within a CampaignProvider");return e}export{gn as C,mn as O,R as c,vn as u};
