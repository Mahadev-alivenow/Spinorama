import{l as c}from"./index-CRk6jtUA.js";import"./_commonjsHelpers-gnU0ypJ3.js";var i={};async function u(r,e){if(e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Allow-Methods","GET, POST, OPTIONS"),e.setHeader("Access-Control-Allow-Headers","Content-Type"),e.setHeader("Content-Type","application/json"),e.setHeader("Cache-Control","no-store, max-age=0"),r.method==="OPTIONS")return e.status(200).end();try{const t=i.MONGODB_URI;if(!t)return e.status(500).json({connected:!1,error:"MongoDB URI is not defined in environment variables",timestamp:new Date().toISOString()});console.log("Direct DB Test: Attempting to connect to MongoDB...");const o=new c.MongoClient(t,{maxPoolSize:10,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3,retryWrites:!0,retryReads:!0});await o.connect();const n="wheel-of-wonders",s=await o.db(n).listCollections().toArray();return await o.close(),e.status(200).json({connected:!0,dbName:n,shop:"wheel-of-wonders.myshopify.com",collections:s.map(a=>a.name),timestamp:new Date().toISOString()})}catch(t){return console.error("Direct DB Test: Error connecting to MongoDB:",t),e.status(500).json({connected:!1,error:t.message,stack:t.stack,timestamp:new Date().toISOString()})}}export{u as default};
